DELIMITER $$
CREATE FUNCTION FUN_CITA(HORA TIME, NBARBERO VARCHAR(100), FECHAF DATE, CEDULA INT)
RETURNS VARCHAR(20)
BEGIN
DECLARE RESUL VARCHAR(20);
DECLARE IDBARB INT;
				 SELECT ID_BARBERO
                 INTO IDBARB
                 FROM BARBERO 
                 WHERE NOMBREB LIKE NBARBERO;               
    SET RESUL =	 SELECT ESTADO
                 FROM CITA 
                 WHERE ID_HORARIO LIKE HORA AND ID_BARBERO = IDBARB AND FECHA LIKE FECHAF);
                 
    IF RESUL LIKE 'RESERVADO' THEN 
    	RETURN 'RESERVADO';
    ELSE 
    	INSERT INTO CITA (CEDULA, ID_BARBERO, ID_HORARIO, FECHA, DESCRIPCION) 
    	VALUES (CEDULA, IDBARB, HORA, FECHAF, 'RESERVADO')
    	RETURN 'DISPONIBLE';
    END IF;
END $$